

function setMethods(p){
    p.dt = 0.1;
    p.inputsX = [];
    p.inputsY = [];
    p.outputsX;
    p.outputsY;
    p.circlesX = [];
    p.circlesY = [];
    p.graph = [];
    p.n = 300;
    
    p.setup = function() {
        
        p.createCanvas(10000,1000);
    //    c = new Circle(250,250, 100,01, HALF_PI, null);
    //    c1 = new Circle(c.pointX, c.pointY, 50, 0, HALF_PI, c);
        p.inputsY = [170.3325525954366, 172.26078718185425, 174.19471113240573, 176.13198967887556, 178.066488848057, 179.9983262388455, 181.92576270774845, 183.86038624481438, 185.79124426908305, 187.72725777947502, 189.66210093503355, 191.59309738598125, 193.52073002475294, 195.46173432646728, 197.39512462935377, 199.32742250568768, 201.25248821732774, 203.1945661670532, 205.11958740190147, 207.05367922364525, 208.99380433181346, 210.92086893125986, 212.86424387425186, 214.78866841115817, 216.7248350771382, 218.65390685926658, 220.5910327853868, 222.51708419774334, 224.44781189083992, 226.38182969601226, 228.317799865293, 230.2544320842164, 232.19048249376434, 234.12475272145252, 236.05608892155755, 237.9833808244847, 239.92465873603246, 241.84082603906458, 243.78854871139646, 245.70918716945047, 247.64060007135828, 249.5821961366645, 251.5136291219987, 253.4538876502844, 255.38247566643227, 257.31859196901326, 259.2416148677469, 261.170927734375, 263.1059914287925, 265.04626681089405, 266.9709326264891, 268.9098126367069, 270.85225790805066, 272.76715966363383, 274.70490364990553, 276.6446110116741, 278.56532044285444, 280.5073802080821, 282.44984144785116, 284.37173844294915, 286.313444725329, 288.2335716304019, 290.1724550286308, 292.10913856635904, 294.04309977671767, 295.9738161928377, 297.90076534785044, 299.8436386177334, 301.76143241647065, 303.6939868805318, 305.64058394619906, 307.560543761609, 309.4933140934311, 311.4381066530377, 313.3743838512422, 315.3015721448023, 317.2386127987029, 319.16520152536174, 321.1000376307025, 323.02299692685807, 324.9715479519896, 326.9064616677182, 328.8270913954948, 330.770003503986, 332.6967082200671, 334.6247994246351, 336.5711714624483, 338.498182914951, 340.4228116070368, 342.3612303791888, 344.2940981762061, 346.2370230551617, 348.1540833296105, 350.0942125926307, 352.0215525911506, 353.9665009595843, 355.8939798925997, 357.8175483290107, 359.7494611382484, 361.7005082715583, 363.62186827024703, 365.5535091812973, 367.48949870305347, 369.42349667362953, 371.3616090001356, 373.2828094507423, 375.2269355791651, 377.15657688760666, 379.08067383258106, 381.02235886335376, 382.954301420068, 384.8804429149855, 386.81793874185973, 388.7449358464172, 390.6816828456521, 392.62454451944683, 394.00002862068015, 394.7185256987764, 395.43577609026113, 396.14691157560037, 396.85619017690294, 397.55887886915554, 398.2590963692202, 398.956463982635, 399.64645456898677, 400.33297423798774, 401.0196432217538, 401.694066320488, 402.3717249528943, 403.03665262011646, 403.7000335900932, 404.35761792388155, 405.0125735792179, 405.6538225586113, 406.2950620925687, 406.9287710864795, 407.5610591300437, 408.1783522891393, 408.79310814963526, 409.40444730006345, 410.0056093244766, 410.5961866329551, 411.1813161417425, 411.75471566439245, 412.32118628904755, 412.8798123892229, 413.424801776844, 413.96513401589414, 414.4903108575627, 415.0042611319491, 415.5102009756341, 416.0026525573156, 416.48065295301797, 416.9432346159439, 417.3962615925184, 417.82793327187204, 418.24693443167956, 418.6454348554025, 419.02770118009164, 419.3915180060553, 419.7302077346007, 420.0487773895545, 420.34250895756816, 420.6090836711729, 420.84616049725463, 421.052493705966, 421.2258907835558, 421.3625262856464, 421.4585147879762, 421.5099182015171, 421.5127533314299, 421.46149395170863, 421.35145688417305, 421.1748223105959, 420.92407500401316, 420.59156587612296, 420.1695383929876, 419.6459107780457, 419.0060000752862, 418.24903708258233, 417.360824575767, 416.32450939926906, 415.1508713594434, 413.8425058827407, 412.3959719184142, 410.82725355401203, 409.1577844629752, 407.40323314196894, 405.5700749584561, 403.6886329883564, 401.7807464547355, 399.8305065648443, 397.8717473281775, 395.8855413588708, 393.89225551434265, 391.89873249311376, 389.9113934960499, 387.90502807072073, 385.8991498384546, 383.8981574403696, 381.90620507210497, 379.91029059778657, 377.9132475091441, 375.91777855478614, 373.9264599667117, 371.94174561457544, 369.96597108770334, 367.9828819333343, 365.993929519385, 364.0194278793334, 362.0422293016763, 360.0636185677342, 358.0848360134687, 356.10707845967636, 354.1315001331518, 352.1592135788196, 350.1711318993941, 348.2084565645396, 346.2317281559774, 344.26208104918953, 342.2797400190996, 340.3060746610861, 338.3210162876919, 336.34614580158484, 334.3611263454723, 332.3877268958367, 330.40536702451317, 328.43598122023116, 326.4480031544449, 324.4633954301021, 322.4827429813877, 320.48486603505336, 318.5028494136168, 316.5154644241976, 314.5231647672551, 312.5264041432487, 310.54764285435436, 308.54335798231, 306.55804272413263, 304.5480285177985, 302.5579344797595, 300.55505547200653, 298.55088822440433, 296.55695789688394, 294.56263377738617, 292.56835477297477, 290.5524108847976, 288.55955155198444, 286.5680589321937, 284.5562760946148, 282.56886102671604, 280.58413426977586, 278.5805361774499, 276.6025448526954, 274.6066544875647, 272.6371737844172, 270.6616857883194, 268.6915911681107, 266.72733618668724, 264.7693671069453, 262.8288911967877, 260.87407170409045, 258.94831467467617, 257.03053722471, 255.12117826125564, 253.22067669137672, 251.32947142213692, 249.46885150136833, 247.61817609101536, 245.77786962986227, 243.9483565566934, 242.1504277176018, 240.3638763275062, 238.609212704697, 236.86646690499038, 235.14594446472375, 233.45765678503494, 231.77225833554525, 230.13877774346412, 228.51822969884006, 226.91097104937182, 225.3551404762268, 223.81264602145768, 222.30238021937436, 220.8149669098354, 219.35957608045751, 217.9269728646463, 216.5350647611931, 215.16565084719642, 213.81874090436963, 212.51167239226925, 211.2353146138181, 209.97239591126797, 208.74834513394217, 207.55426495647524, 206.38161351710434, 205.238447348089, 204.1163908735478, 203.02329718787084, 201.96663688715032, 200.92252103827911, 199.89176271146746, 198.8446887898826, 197.78248442698634, 196.7063560649432, 195.60312707043707, 194.4889104756096, 193.36498279042033, 192.20526612361272, 191.02600581443122, 189.8293223322624, 188.6044814725015, 187.34190182264092, 186.03325328080723, 184.69558411650664, 183.32147958794494, 181.8822753447968, 180.3867026447281, 178.82272490818156, 177.16159823053033, 175.4114460066431, 173.55575848519803, 171.62235480330767, 169.62450388509168, 167.68677230801205, 165.93387383098715, 164.41659927869486, 163.11968453809698, 162.01629835687578, 161.07233141354976, 160.23953660813925, 159.51596932027448, 158.87247969023593, 158.30153702307166, 157.78475417198493, 157.3214373735469, 156.90354460953913, 156.52418872655534, 156.18047800360313, 155.86690351988304, 155.58143412146964, 155.3197085263595, 155.08491945576148, 154.8685088723032, 154.6726699380311, 154.49511365857492, 154.3339003174752, 154.18893634764476, 154.05780568562517, 153.94117436895823, 153.83638483506343, 153.744589341681, 153.66355146544714, 153.59332039801996, 153.53405989214733, 153.4838396461994, 153.4429656962806, 153.4111537604524, 153.3874363945945, 153.37190589618675, 153.3639155246003, 153.3633015137911, 153.36966462115976, 153.38283543231782, 153.40254626574819, 153.42835954927395, 153.4603847575875, 153.49796147829733, 153.54168939606737, 153.59051892624862, 153.6441175596132, 153.7034454680936, 153.76712252521224, 153.83633264208072, 153.90948572230567, 153.98741420425225, 154.07002401154506, 154.15596152306534, 154.24626781822252, 154.3408527399755, 154.43962613128323, 154.5417487173037, 154.64782303874256, 154.75695634901302, 154.86981141781263, 154.9863018970382, 155.10634143858653, 155.22984369435434, 155.35579096767947, 155.4849813670314, 155.61733040787, 155.7527536056552, 155.89116647584677, 156.03248453390472, 156.1755611714598, 156.32241648531726, 156.4719241500962, 156.62399968125655, 156.7785585942581, 156.9355164045608, 157.09478862762452, 157.25747761674285, 157.42114056129276, 157.5880808739075, 157.7570253686501, 157.92913261841832, 158.10183938962152, 158.27883135074825, 158.45624635556754, 158.63654751680306, 158.819678328274, 159.00295049536086, 159.19021400791692, 159.3787667962305, 159.56985505227146, 159.7620593228288, 159.95663811303814, 160.15487465964384, 160.35260491218014, 160.5538257272802, 160.75571112412683, 160.9609144765232, 161.1665847040459, 161.3753805427032, 161.5844311288269, 161.79639453930903, 162.00977107071574, 162.225824488295, 162.44165885804534, 162.66128930244636, 162.8818069625817, 163.10443870648822, 163.32765165171068, 163.55400836326692, 163.78194864989257, 164.0112728392561, 164.24176944242686, 164.47453959919082, 164.70799905392607, 164.9457954374826, 165.18239182466863, 165.42135412754376, 165.66353117736443, 165.90472900390625, 166.14944866234976, 166.3946742319591, 166.6421906268438, 166.89125242905033, 167.14326840436186, 167.3950085498369, 167.6496751046021, 167.90375125674515, 168.16159739235346, 168.42266344463877, 168.68223020429795, 168.94529204747];
        for(let i = 0; i<p.inputsY.length; ++i){
            p.inputsY[i] -= 160;
            p.inputsY[i] = -p.inputsY[i]
        }
        let val = -150;
        let steps = 0.1;
        let len = 776;
        p.inputsX = [272.3306782081723, 272.8429977226257, 273.35682886449786, 273.87155130090656, 274.3855352746651, 274.8988120310427, 275.41091949081124, 275.92493650831597, 276.4379530533151, 276.95233937778295, 277.46641474650704, 277.9794680705835, 278.4916276514231, 279.00733999701157, 279.5210293521351, 280.0344284565573, 280.5459060213854, 281.0619036283377, 281.57336937596864, 282.0872451201357, 282.60272386965977, 283.11473252610796, 283.6310747358203, 284.1423819446499, 284.65680896157147, 285.16935091353486, 285.6840327996993, 286.19577225886127, 286.70875417570716, 287.2226102541478, 287.73698506316146, 288.25153577450254, 288.7659319028386, 289.2798550483164, 289.7929986415565, 290.305067691076, 290.82085273303557, 291.32996604799, 291.8474634213946, 292.3577646934503, 292.87092866586545, 293.3867982392302, 293.8999675476825, 294.41548174607266, 294.9278951645298, 295.4423088002205, 295.9532436028123, 296.46584960937497, 296.97998357385393, 297.49550225019453, 298.0068735652183, 298.5220215002336, 299.03811670217476, 299.54689376932043, 300.0617398700877, 300.5771076270831, 301.0874277562415, 301.6034205316897, 302.11951997633867, 302.63015563358374, 303.1460544909153, 303.65621984663755, 304.1713686818257, 304.68593302824274, 305.19977406980576, 305.71275299043157, 306.224730974037, 306.74093989243437, 307.25048535682527, 307.76395263495453, 308.28115094191566, 308.7912719029904, 309.3047965357938, 309.8215153971131, 310.335971781735, 310.8480133029128, 311.3626725327976, 311.87455475291017, 312.3886282484368, 312.89954615223314, 313.41726361364306, 313.9313577297501, 314.4416566822273, 314.95787591979274, 315.469788957548, 315.9820703763672, 316.4992088948763, 317.0112034305238, 317.5225648820702, 318.03759026910114, 318.55114079777945, 319.0673634283751, 319.5767140000854, 320.0921938535269, 320.60427568173577, 321.12103594045726, 321.63315468266705, 322.1442344311072, 322.6575312256813, 323.17591188696275, 323.6864048677194, 324.19962942069566, 324.7140093715375, 325.22786018005354, 325.74280414644954, 326.253254736308, 326.7697965311527, 327.28248980259053, 327.7937099723531, 328.3096031832695, 328.8229078815565, 329.3346712750749, 329.8494514414881, 330.36144216497894, 330.8760233727097, 331.39222921010105, 332.5227697518849, 334.3869115143886, 336.2585645687846, 338.12531825984195, 339.998649088823, 341.86636119751097, 343.739713326603, 345.61812585867176, 347.4897295975583, 349.3654519360848, 351.25577299810845, 353.1269176753988, 355.02232579757646, 356.89783749390574, 358.7853723865992, 360.67350429261637, 362.5720154764545, 364.4491956469152, 366.3457094065243, 368.2402163879072, 370.15191658882304, 372.0403882753674, 373.94437989876565, 375.862561683574, 377.7747843038229, 379.68045229385064, 381.597277495398, 383.5058561456345, 385.4233898478602, 387.34851445337523, 389.2625887842699, 391.1990381013336, 393.1222088613763, 395.0479876675347, 396.9911810304049, 398.93365336380464, 400.8740048505245, 402.8108347813236, 404.77287851502433, 406.71267225853404, 408.67313781737346, 410.62273059073004, 412.58782380324175, 414.56520352848986, 416.5250890579611, 418.50496279750587, 420.48796749170674, 422.4708088104941, 424.450181420957, 426.4344192130983, 428.4304962663259, 430.4330210875457, 432.43655796139586, 434.4356413595313, 436.4247908302159, 438.43646749723433, 440.4242137408074, 442.4173691544275, 444.4057301090777, 446.3790346458201, 448.32701450931853, 450.2535077524185, 452.1589508350382, 454.00346781525997, 455.78866277071864, 457.51282747150157, 459.1327919909403, 460.6340462159378, 462.01387790138443, 463.2561736650065, 464.3518830434797, 465.3037073931529, 466.12167482022267, 466.80747958198845, 467.3707896045613, 467.83091397204794, 468.19292527441377, 468.47210865692807, 468.67534404470064, 468.8115103234756, 468.8887875386338, 468.9147308559007, 468.8945148581262, 468.83367444099474, 468.73733691848815, 468.6090305824338, 468.4523819039368, 468.2707926728534, 468.06744832315485, 467.8453261159772, 467.60720318035703, 467.3532351065951, 467.0853936823719, 466.8082671238367, 466.5211824022535, 466.2258160197507, 465.9237651441838, 465.6165494414265, 465.3056128898736, 464.9923255771537, 464.6747601754498, 464.36056948746847, 464.0444589015317, 463.7307789180587, 463.41732785182126, 463.10839658153856, 462.801733793905, 462.5015291189892, 462.2055259605545, 461.917772410819, 461.6360495695478, 461.3642250254279, 461.09874694553196, 460.84341303460644, 460.5989976501074, 460.3637488922016, 460.14232050054125, 459.93299084582713, 459.73665362502834, 459.55420253511375, 459.3882902790897, 459.2361154488513, 459.1018951261184, 458.98353216797, 458.8845005380581, 458.80387607210207, 458.74313888685276, 458.7033302081862, 458.68492358542335, 458.68878357557395, 458.71620782740416, 458.767466190061, 458.84359444284917, 458.9467367638807, 459.0754988689135, 459.2317341412957, 459.41852038578446, 459.6326249901497, 459.87969136540585, 460.1551620612841, 460.464245546439, 460.8063777266429, 461.1824376483888, 461.5933043581698, 462.0372901208567, 462.52297432780864, 463.04055518080713, 463.596031916216, 464.1902690910449, 464.8241312623034, 465.4984829870013, 466.20600619386283, 466.95480569384995, 467.7457175444256, 468.57957780305287, 469.44711505547326, 470.35826657169184, 471.3027292063209, 472.2913913822267, 473.31896358079837, 474.37910459349473, 475.49077562574143, 476.6212039220205, 477.7964259681545, 479.01714468101284, 480.25335597515107, 481.5342469574231, 482.84402238905875, 484.19016183101746, 485.5636741399185, 486.97254650300187, 488.39785233623115, 489.85686899838635, 491.3492995192175, 492.854479090176, 494.3808492485001, 495.94868488459963, 497.52541620316316, 499.12027367958683, 500.7435911492588, 502.38310336698413, 504.0496750132752, 505.7304573509562, 507.4114792549631, 509.12924640587005, 510.83322570345945, 512.5340230318711, 514.2272893425917, 515.9086103692439, 517.5952850268009, 519.2592877484983, 520.8959966964474, 522.5389731824163, 524.1597818532326, 525.7507609497486, 527.3203365658725, 528.8727449476519, 530.4077008996621, 531.8941153369701, 533.328545501352, 534.7235231716464, 536.0479269635432, 537.2850448742089, 538.4180741069359, 539.3889909392401, 540.1385787814855, 540.5705266896904, 540.5822574681638, 540.0939331034185, 539.1425780473929, 537.846033341466, 536.3169036270652, 534.6483918907493, 532.9002051552592, 531.0657566810943, 529.2085340445096, 527.3137353957434, 525.4066616549136, 523.4646703093764, 521.5180933430935, 519.5657025447058, 517.6024915102978, 515.637991988125, 513.6626929424027, 511.6832802998579, 509.6865946237175, 507.71697573716904, 505.72024610195143, 503.73025386491287, 501.74077797276493, 499.74454537026577, 497.7553828721233, 495.754102654565, 493.76548405461364, 491.75780998711645, 489.7675751788304, 487.7618667213014, 485.7539342078172, 483.7697482918805, 481.76247141058656, 479.75766320940454, 477.7693410231642, 475.76119063937557, 473.7722533741747, 471.7654021280029, 469.7672761660814, 467.77908172778416, 465.775513559709, 463.7704353383336, 461.7780764289596, 459.77248021110546, 457.78132659300934, 455.76460150398174, 453.763788751689, 451.7798177062976, 449.7719306051444, 447.78222820581345, 445.7695235927011, 443.776286789532, 441.77506311400424, 439.76629071193133, 437.7788478026632, 435.7849130922974, 433.7849064729693, 431.7792478368138, 429.7827381450307, 427.7814817648114, 425.7903328839808, 423.7953125860847, 421.7968230237339, 419.7952663495387, 417.79104471610987, 415.79910719669175, 413.80533301949, 411.8101156578652, 409.8138485851779, 407.8169252747887, 405.819739200058, 403.83725946035383, 401.8407230253212, 399.8451013739605, 397.85078797963234, 395.8581763156973, 393.86765985551585, 391.8796320724487, 389.88000788919027, 387.8981632366123, 385.90556580366336, 383.9170962936201, 381.9187980006003, 379.9398280026166, 377.93763314878754, 375.95558850712, 373.9655928460241, 371.9682062294389, 369.992182777486, 367.9956885153333, 366.00744346018735, 364.01397705475125, 362.0297682578074, 360.0414920439321, 358.0361167887115, 356.0554249882159, 354.0590299433625, 352.0748149802987, 350.0765319696906, 348.09176830920376, 346.09467503210453, 344.1125131923155, 342.1198666842024, 340.1307774121717, 338.1333873983689, 336.1542205302309, 334.1563465758308, 332.16624853255024, 330.1727032808236, 328.1892696329745, 326.19312597853525, 324.19809121229684, 322.20580782535995, 320.21798182548696, 318.2250826480579, 316.2406079379576, 314.2336842728815, 312.25101598929734, 310.26253227275924, 308.2613854499137, 306.28217041015625, 304.2879342665775, 302.30338173541037, 300.31411067963654, 298.32626482346666, 296.3288338745044, 294.3475309132378, 292.3572995074488, 290.3857879508255, 288.39945114454474, 286.40321054869867, 284.43348131610543, 282.45284667790065, 280.48065207891165, 278.5130583939701, 276.5406127929688, 274.58437580388]
    //    for(let i = 0; i<= len;++i){
    //        p.append(p.inputsX, -150 + (300*i)/(len));
    //    }
        p.outputsX = p.DFT(p.inputsX);
        p.outputsX.sort(function(a,b){return b.amplitude-a.amplitude});
        p.outputsY = p.DFT(p.inputsY);
        p.outputsY.sort(function(a,b){return b.amplitude-a.amplitude});
        let c = new Circle(100,350,0,0,0);
        for(let i = 0; i<p.outputsY.length; ++i){
            let c1 = new Circle(c.pointX,c.pointY, p.outputsY[i].amplitude,p.outputsY[i].frequency, p.outputsY[i].phase +Math.PI+ Math.HALF_PI, c);
            p.append(p.circlesY, c1);
            c = c1;
        }
        c = new Circle(450,100,0,0,0);
        for(let i = 0; i<p.outputsX.length; ++i){
            c1 = new Circle(c.pointX,c.pointY, p.outputsX[i].amplitude,p.outputsX[i].frequency, p.outputsX[i].phase, c);
            p.append(p.circlesX, c1);
            c = c1;
        }
        p.dt = 0.03/*(TWO_PI/inputs.length)*/;
    //    console.log(p.inputsY.length);
    }

    p.draw = function() {
        p.background(0);
        p.stroke(255);
        p.noFill();
    //    line(0,350, 300, 350);
    //    line(0,150,300,150);
        for(let i = 0; i<p.circlesX.length;++i){
            p.circlesX[i].show(p);
            p.circlesX[i].update(p.dt); 
            p.circlesY[i].show(p);
            p.circlesY[i].update(p.dt); 
        }
    //    noLoop();
        p.graph.unshift(p.createVector( p.circlesX[p.circlesX.length-1].pointX, p.circlesY[p.circlesY.length-1].pointY));
        p.strokeWeight(1);
        p.beginShape();
        for(let i=0;i<p.graph.length;++i){
            p.vertex(p.graph[i].x, p.graph[i].y);
        }
        p.endShape();
        p.stroke(255,0,0);
        p.line(p.circlesY[p.circlesY.length-1].pointX,p.circlesY[p.circlesY.length-1].pointY,p.circlesX[p.circlesX.length-1].pointX,p.circlesY[p.circlesY.length-1].pointY);
        p.line(p.circlesX[p.circlesX.length-1].pointX,p.circlesX[p.circlesX.length-1].pointY,p.circlesX[p.circlesY.length-1].pointX,p.circlesY[p.circlesY.length-1].pointY);
        
    //    c1.show(p);
    //    c1.update(p.dt);
    //    console.log(DFT(inputs, inputs.length));
        
    }

    p.DFT = function(inputs){
        const N = inputs.length;
        let outputs = [];
        let re = 0;
        let img = 0;
        let frequency;
        let amplitude;
        let phase;
        let n_ = Math.floor(p.n/2);
        for(let i = (-1)*p.n; i<=p.n; ++i){
            for(let j = 0; j<N; ++j){
                let theta = (Math.TWO_PI * i * j)/(N);
                re += inputs[j]*Math.cos(theta);
                img -= inputs[j]*Math.sin(theta);
            }

            re = re/N;
            img = img/N;
            frequency = i;
            amplitude = Math.sqrt(re*re + img*img);
            phase = Math.atan2(img, re);
            p.append(outputs, {re, img, frequency, amplitude, phase});
        }
        return outputs;
    }
}

let sketch = new p5(setMethods, 'sketchContainer');